---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.3.2
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

<!-- #region toc=true -->
<h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"></ul></div>
<!-- #endregion -->

```{python}
import numpy as np
import matplotlib.pyplot as plt

coeffs = np.array([1, 1, 1, 1])


```

```{python}
xs = np.linspace(0, 5 * np.pi, 100)

```

```{python}


ys = np.round(np.sin(xs) * 15)
```

```{python}
plt.plot(xs, ys)
```

```{python}
ys_2 = np.convolve(ys, coeffs, mode='full')
```

```{python}
plt.plot(ys_2)
```

```{python}
ys_2
```

```{python}
np.savetxt("input_vectors.txt", ys, fmt='%d')
```

```{python}
a = np.convolve(np.arange(10).repeat(2)[2:], coeffs, mode='full')
```

```{python}
np.arange(10).repeat(2)
```

```{python}
a
```

```{python}
from scipy import signal

sampling_frequency = 500
numtaps = 16
coefficients = signal.firwin(numtaps, 3, pass_zero='lowpass', fs = sampling_frequency)
```

```{python}
duration = 1
xs = np.linspace(0, duration, duration * sampling_frequency)

def sinusoidal_wave(xs, f):
    return np.sin(2 * np.pi * f * xs)

input_signal = 5 * sinusoidal_wave(xs, 1) + 3 * sinusoidal_wave(xs, 50) + 3 * sinusoidal_wave(xs, 180)
input_signal /= max(max(input_signal), -1 * min(input_signal))

```

```{python}
plt.plot(xs, input_signal)
```

```{python}
filtered_signal = np.convolve(input_signal, coefficients, mode='same')

plt.plot(xs, input_signal, c='b', label='Input')
plt.plot(xs, filtered_signal, c='r', label='Output')
#plt.plot(xs, 3 * sinusoidal_wave(xs, 5), '--', c='g', label='5 Hz')
plt.xlim(0,1)

plt.legend()
```

```{python}

```
